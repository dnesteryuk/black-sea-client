!function(){"use strict";var e={records:[],add:function(e){this.records.push({method:e.method,url:e.url})},modifiedState:function(e,n,i,s){void 0===s&&(s=[]);var c=function(e){return this.records.findIndex(function(t){return t.url===e})}.call(this,e),o=t.call(this,n),d=this.records[c],a=this.records[o];if(!d||r(a.method))return!0;for(var u=new RegExp("^http(s)?://"+i),f=c+1;f<o;f++){var l=this.records[f];if(!(s.indexOf(l.url)>-1)&&u.test(l.url)&&r(l.method))return!0}return!1},clean:function(){this.records=[]},removeAllBefore:function(e){var r=t.call(this,e);r<0||(this.records=this.records.slice(r,this.records.length))}};function t(e){return this.records.reduce(function(t,r,n){return r.url===e&&(t=n),t},-1)}function r(e){return"GET"!==e&&"OPTIONS"!==e}var n=function(e){return caches.match(e,{cacheName:"sirko-prefetch"}).then(function(t){return t||fetch(e)}).catch(function(){return caches.match(e,{cacheName:"sirko-offline"})})};self.addEventListener("install",function(e){e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())}),self.addEventListener("message",function(t){var r=t.data,n=e.modifiedState(r.referrer,r.currentUrl,r.domain,[r.engineUrl]);e.removeAllBefore(r.currentUrl),t.ports[0].postMessage({isStateModified:n})}),self.addEventListener("fetch",function(t){var r=t.request;e.add({method:r.method,url:r.url}),"GET"===r.method&&t.respondWith(n(r))})}();
