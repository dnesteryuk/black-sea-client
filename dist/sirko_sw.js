!function(){"use strict";var n={records:[],add:function(e){this.records.push({method:e.method,url:e.url})},modifiedState:function(e,t,r,n){void 0===n&&(n=[]);var i=function(t){return this.records.findIndex(function(e){return e.url===t})}.call(this,e),c=f.call(this,t),s=this.records[i],o=this.records[c];if(!s||l(o.method))return!0;for(var d=new RegExp("^"+r),u=i+1;u<c;u++){var a=this.records[u];if(!(-1<n.indexOf(a.url))&&d.test(a.url)&&l(a.method))return!0}return!1},clean:function(){this.records=[]},removeAllBefore:function(e){var t=f.call(this,e);t<0||(this.records=this.records.slice(t,this.records.length))}};function f(n){return this.records.reduce(function(e,t,r){return t.url===n&&(e=r),e},-1)}function l(e){return"GET"!==e&&"OPTIONS"!==e}var e="sirko-prefetch",r="sirko-offline",i=function(t){return caches.match(t,{cacheName:e}).then(function(e){return e||fetch(t)}).catch(function(){return caches.match(t,{cacheName:r})})};self.addEventListener("install",function(e){e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())}),self.addEventListener("message",function(e){var t=e.data,r=n.modifiedState(t.referrer,t.currentUrl,t.origin,[t.engineUrl]);n.removeAllBefore(t.currentUrl),e.ports[0].postMessage({isStateModified:r})}),self.addEventListener("fetch",function(e){var t=e.request;n.add({method:t.method,url:t.url}),"GET"===t.method&&e.respondWith(i(t))})}();
