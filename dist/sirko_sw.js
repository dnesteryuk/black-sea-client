!function(){"use strict";var e={records:[],add:function(e){this.records.push({method:e.method,url:e.url})},modifiedState:function(e,t,r,n){var i=this;void 0===n&&(n=[]);var d=this._findIndexOfOldestRecord(e),s=this._findIndexOfNewestRecord(t),o=this.records[d],f=this.records[s];if(!o||this._methodModifingData(f.method))return!0;for(var c=new RegExp("^http(s)?://"+r),a=d+1;a<s;a++){var u=i.records[a];if(!(n.indexOf(u.url)>-1)&&c.test(u.url)&&i._methodModifingData(u.method))return!0}return!1},clean:function(){this.records=[]},removeAllBefore:function(e){var t=this._findIndexOfNewestRecord(e);t<0||(this.records=this.records.slice(t,this.records.length))},_findIndexOfOldestRecord:function(e){return this.records.findIndex(function(t){return t.url===e})},_findIndexOfNewestRecord:function(e){return this.records.reduce(function(t,r,n){return r.url===e&&(t=n),t},-1)},_methodModifingData:function(e){return"GET"!==e&&"OPTIONS"!==e}};self.addEventListener("install",function(e){e.waitUntil(self.skipWaiting())}),self.addEventListener("activate",function(e){e.waitUntil(self.clients.claim())}),self.addEventListener("message",function(t){var r=t.data,n=e.modifiedState(r.referrer,r.currentUrl,r.domain,[r.engineUrl]);e.removeAllBefore(r.currentUrl),t.ports[0].postMessage({isStateModified:n})}),self.addEventListener("fetch",function(t){var r=t.request;if(e.add({method:r.method,url:r.url}),"GET"===r.method){var n=caches.match(r,{cacheName:"sirko-pages"}).then(function(e){return e||fetch(r)});t.respondWith(n)}})}();
