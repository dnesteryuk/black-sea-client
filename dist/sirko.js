!function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var r,t=(function(r){var t,n,i,o,a,s,c,l,u,d,f,p,h,v,w,g,b,y,P;t=e,n=/iPhone/i,i=/iPod/i,o=/iPad/i,a=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,c=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,l=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,u=/Windows Phone/i,d=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,f=/BlackBerry/i,p=/BB10/i,h=/Opera Mini/i,v=/(CriOS|Chrome)(?=.*\bMobile\b)/i,w=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,g=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),b=function(e,r){return e.test(r)},y=function(e){var r=e||navigator.userAgent,t=r.split("[FBAN");if(void 0!==t[1]&&(r=t[0]),void 0!==(t=r.split("Twitter"))[1]&&(r=t[0]),this.apple={phone:b(n,r),ipod:b(i,r),tablet:!b(n,r)&&b(o,r),device:b(n,r)||b(i,r)||b(o,r)},this.amazon={phone:b(c,r),tablet:!b(c,r)&&b(l,r),device:b(c,r)||b(l,r)},this.android={phone:b(c,r)||b(a,r),tablet:!b(c,r)&&!b(a,r)&&(b(l,r)||b(s,r)),device:b(c,r)||b(l,r)||b(a,r)||b(s,r)},this.windows={phone:b(u,r),tablet:b(d,r),device:b(u,r)||b(d,r)},this.other={blackberry:b(f,r),blackberry10:b(p,r),opera:b(h,r),firefox:b(w,r),chrome:b(v,r),device:b(f,r)||b(p,r)||b(h,r)||b(w,r)||b(v,r)},this.seven_inch=b(g,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},P=function(){var e=new y;return e.Class=y,e},r.exports&&"undefined"==typeof window?r.exports=y:r.exports&&"undefined"!=typeof window?r.exports=P():t.isMobile=P()}(r={exports:{}},r.exports),r.exports),n={call:function(e){return!new t.Class(e.request.agent).any&&e}},i={call:async function(e){navigator.serviceWorker.register("/sirko_sw.js");var r=await navigator.serviceWorker.ready;return e.serviceWorker=r.active,e}},o={call:function(e){var r=e.request.referrer,t=new RegExp("^"+e.request.origin);return r&&!t.test(r)&&(r=null),e.request.referrer=r,e}},a={call:function(e){var r=e.request,t=new RegExp("^"+r.origin);return r.currentPath=r.currentUrl.replace(t,""),r.referrer&&(r.referrer=r.referrer.replace(t,"")),e}},s=window.sessionStorage,c=function(e,r){"object"==typeof r&&(r=JSON.stringify(r)),s.setItem(e,r)},l=function(e){var r=s.getItem(e);if(r)return"{"===r.charAt(0)&&(r=JSON.parse(r)),r},u=function(e,r){var t=s.getItem(e);t&&s.setItem(r,t)},d={call:function(e){return l("lastPredictionFor")!==e.request.currentPath&&e}},f=async function(){var e=await Promise.all([caches.open("sirko-prefetch"),caches.open("sirko-offline")]),r=e[0],t=e[1];(await r.keys()).forEach(async function(e){var n=await r.match(e);await t.put(e,n),r.delete(e)})},p=async function(e,r){var t=await caches.open("sirko-prefetch");!function(e,r){r.forEach(function(r){e.add(new Request(r.path,{credentials:"include",redirect:"follow"}))})}(t,e),function(e,r){r.forEach(function(r){e.add(r)})}(t,r)},h=function(){return caches.delete("sirko-prefetch")};var v={call:function(e,r){return r.offline?f():h(),e}},w={call:function(e,r){var t=[];return b(document.querySelectorAll('link[rel="stylesheet"]'),t,"href"),b(document.querySelectorAll("script[src]"),t),r.imagesSelector&&b(document.querySelectorAll(r.imagesSelector),t),e.request.assets=t,e}},g=new RegExp("^http(s)?://");function b(e,r,t){void 0===t&&(t="src"),Array.prototype.slice.call(e).forEach(function(e){var n;n=e[t],g.test(n)&&r.push(e[t])})}var y={call:function(e,r){var t=e.request;return new Promise(function(n,i){var o=new MessageChannel;o.port1.onmessage=function(r){r.data.isStateModified&&(t.referrer=null),n(e)},e.serviceWorker.postMessage({referrer:t.referrer,currentUrl:t.currentUrl,origin:t.origin,engineUrl:r.engineUrl},[o.port2])})}},P=function(e){this.engineUrl=e,this.xhr=new XMLHttpRequest};P.prototype.predict=function(e){var r=this;return new Promise(function(t){r._makePrediction(e,t)})},P.prototype._makePrediction=function(e,r){var t=this;this.xhr.withCredentials=!0,this.xhr.open("POST",this.engineUrl),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.onload=function(){r(JSON.parse(t.xhr.response))},this.xhr.send(this._requestBody(e))},P.prototype._requestBody=function(e){var r={current:e.currentPath,assets:e.assets};return e.referrerPath&&(r.referrer=e.referrerPath),JSON.stringify(r)};var m={pipes:[n,i,o,y,a,d,v,w,{call:async function(e,r){if(e.prediction)return e;var t=new P(r.engineUrl),n=e.request,i=await t.predict({currentPath:n.currentPath,referrerPath:n.referrer,assets:n.assets});return e.prediction=i,e}},{call:function(e){var r=e.prediction.pages,t=e.prediction.assets;return r.length&&p(r,t),e}},{call:function(e){return u("lastPrediction","prevPrediction"),c("lastPrediction",e.prediction),c("lastPredictionFor",e.request.currentPath),e}},{call:function(e){var r,t=l("prevPrediction"),n=e.prediction;return t&&t.pages.length&&(r=t.pages.findIndex(function(r){return r.path===e.request.currentPath})>-1),[n.pages,r]}}],call:function(e,r){var t=Promise.resolve({request:e});return this.pipes.forEach(function(e){t=t.then(function(t){return(t=e.call(t,r))?Promise.resolve(t):Promise.reject()})}),t}},A=function(e,r){return r.engineUrl=r.engineUrl+"/predict",m.call(e,r)},x=window.sirko;if("serviceWorker"in navigator&&x){var q={agent:window.navigator.userAgent,referrer:document.referrer,currentUrl:window.location.href,origin:window.location.origin},k={};x.q.forEach(function(e){var r=e[0],t=e[1];k[r]=t}),window.sirko=function(e,r){k.prediction&&"predicted"===e?r.apply(this,k.prediction):k[e]=r},A(q,k).then(function(e){try{var r=k.predicted;r&&r.apply(r,e),k.prediction=e}catch(e){console.error(e)}}).catch(function(){var e=k.rejected;e&&e.apply(e)})}}();
