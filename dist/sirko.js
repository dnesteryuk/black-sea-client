!function(){"use strict";var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=function(e,r){return r={exports:{}},e(r,r.exports),r.exports}(function(r){!function(e){var t=/iPhone/i,i=/iPod/i,n=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,c=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,a=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,d=/Windows Phone/i,u=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,p=/BlackBerry/i,l=/BB10/i,h=/Opera Mini/i,f=/(CriOS|Chrome)(?=.*\bMobile\b)/i,v=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,b=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),w=function(e,r){return e.test(r)},P=function(e){var r=e||navigator.userAgent,P=r.split("[FBAN");if(void 0!==P[1]&&(r=P[0]),void 0!==(P=r.split("Twitter"))[1]&&(r=P[0]),this.apple={phone:w(t,r),ipod:w(i,r),tablet:!w(t,r)&&w(n,r),device:w(t,r)||w(i,r)||w(n,r)},this.amazon={phone:w(c,r),tablet:!w(c,r)&&w(a,r),device:w(c,r)||w(a,r)},this.android={phone:w(c,r)||w(o,r),tablet:!w(c,r)&&!w(o,r)&&(w(a,r)||w(s,r)),device:w(c,r)||w(a,r)||w(o,r)||w(s,r)},this.windows={phone:w(d,r),tablet:w(u,r),device:w(d,r)||w(u,r)},this.other={blackberry:w(p,r),blackberry10:w(l,r),opera:w(h,r),firefox:w(v,r),chrome:w(f,r),device:w(p,r)||w(l,r)||w(h,r)||w(v,r)||w(f,r)},this.seven_inch=w(b,r),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},y=function(){var e=new P;return e.Class=P,e};r.exports&&"undefined"==typeof window?r.exports=P:r.exports&&"undefined"!=typeof window?r.exports=y():e.isMobile=y()}(e)}),t={call:function(e){return!new r.Class(e.request.agent).any&&e}},i={call:function(e){return"serviceWorker"in navigator&&(navigator.serviceWorker.register("sirko_sw.js"),caches.delete("sirko-pages")),e}},n={call:function(e){var r=e.request.referrer,t=new RegExp("^http(s)?://"+e.request.domain);return r&&!t.test(r)&&(r=null),e.request.referrer=r,e}},o={call:function(e){var r=e.request,t=new RegExp("^http(s)?://"+r.domain+"(.*)?/");return r.currentPath=r.currentPath.replace(t,"/"),r.referrer&&(r.referrer=r.referrer.replace(t,"/")),e}},s=window.sessionStorage,c={put:function(e,r){"object"==typeof r&&(r=JSON.stringify(r)),s.setItem(e,r)},pull:function(e){var r=s.getItem(e);if(r)return"{"===r.charAt(0)&&(r=JSON.parse(r)),r},shift:function(e,r){var t=s.getItem(e);t&&s.setItem(r,t)},clear:function(){s.clear()}},a={call:function(e){return c.pull("lastPredictionFor")===e.request.currentPath&&(e.prediction=c.pull("lastPrediction"),e.prediction.cached=!0),e}},d={call:function(e){var r=Array.prototype.slice.call(document.querySelectorAll('link[rel="stylesheet"]')).map(function(e){return e.href});return Array.prototype.slice.call(document.querySelectorAll("script[src]")).forEach(function(e){r.push(e.src)}),e.request.assets=r,e}},u=function(e){this.engineUrl=e,this.xhr=new XMLHttpRequest};u.prototype.predict=function(e){var r=this;return new Promise(function(t){r._makePrediction(e,t)})},u.prototype._makePrediction=function(e,r){var t=this;this.xhr.withCredentials=!0,this.xhr.open("POST",this._predictorUrl()),this.xhr.setRequestHeader("Content-Type","application/json"),this.xhr.onload=function(){r(JSON.parse(t.xhr.response))},this.xhr.send(this._requestBody(e))},u.prototype._predictorUrl=function(){return this.engineUrl+"/predict"},u.prototype._requestBody=function(e){var r={current:e.currentPath,assets:e.assets};return e.referrerPath&&(r.referrer=e.referrerPath),JSON.stringify(r)};var p={appendLink:function(e,r){var t=document.createElement("link");t.href=r,t.rel=e,document.head.appendChild(t)}},l={pipes:[t,i,n,o,a,d,{call:function(e,r){if(e.prediction)return e;var t=new u(r.engineUrl),i=e.request;return t.predict({currentPath:i.currentPath,referrerPath:i.referrer,assets:i.assets}).then(function(r){return e.prediction=r,Promise.resolve(e)})}},{call:function(e){var r=e.prediction.path;return r&&"serviceWorker"in navigator&&caches.open("sirko-pages").then(function(e){e.add(r)}),e}},{call:function(e){var r=e.prediction,t=e.request;return r.assets&&r.assets.forEach(function(e){t.assets.indexOf(e)>-1||p.appendLink("prefetch",e)}),e}},{call:function(e){return c.shift("lastPrediction","prevPrediction"),c.put("lastPrediction",e.prediction),c.put("lastPredictionFor",e.request.currentPath),e}},{call:function(e){var r,t=c.pull("prevPrediction"),i=e.prediction;return!i.cached&&t&&t.path&&(r=t.path===e.request.currentPath),[i.path,r]}}],call:function(e,r){var t=Promise.resolve({request:e});return this.pipes.forEach(function(e){t=t.then(function(t){return(t=e.call(t,r))?Promise.resolve(t):Promise.reject()})}),t}},h={predict:function(e,r){return l.call(e,r)}},f=window.sirko;if("undefined"!=typeof Promise&&f){var v={agent:window.navigator.userAgent,referrer:document.referrer,currentPath:window.location.href,domain:document.domain},b={};f.q.forEach(function(e){var r=e[0],t=e[1];b[r]=t}),window.sirko=function(e,r){b.prediction&&"predicted"===e?r.apply(this,b.prediction):b[e]=r},h.predict(v,b).then(function(e){b.predicted&&b.predicted.apply(b.predicted,e),b.prediction=e})}}();
